\section{Monte Carlo simulation of Hard spheres in the NVT ensemble (compleetly my own code)}

In this exercise we have a couple of assignment that have to be done. The web app used for plotting is found at \url{https://webspace.science.uu.nl/~herme107/viscol/}.

The main function in which the logic from the other functions is found is in \ref{app:E4.g}.



\subsection{}

Here we had to make code that tiled the space whit spheres in a cubic lattice formation. The code for the generation of this lattice is found in Appendix~\ref{app:E4.a}.

On the web app for plotting this lattice, Figure~\ref{fig: cubic lattice} was made using the file that was generated.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.5\linewidth]{graphs/E4/Cubic.png}
	\caption{Here the cubic lattice generated by the code is graphed}
	\label{fig: cubic lattice}
\end{figure}




\subsection{} \label{sec:4b}
We want to know the maximum packing density for spheres in a cubic lattice.

To get this first we need the lattice vector equation 
\begin{equation}
	\vec{R} = N_1 \vec{a_1}+N_2 \vec{a_2}+N_3 \vec{a_3}.
	\label{eq: lattice vector}
\end{equation}
Here the $N_i \in \mathcal{Z}$ is the counting number and $\vec{a_i}$ are the primitive translation vectors.

For the cubic case the vectors are unit vectors times the radius of the atoms. Dividing this up into unit cells gives us that only one atom may exist in the unit cell. meaning that the occupied fraction

\begin{eqnarray}
	f_{o} = \frac{V_p}{V_{uc}} = \frac{\frac{4}{3}\pi (\frac{a}{2})^3}{a^3} = \frac{\pi}{6}
\end{eqnarray}

Here $V_p$ is the volume of particles occupying the unit cell, $V_{uc}$ is the volume of the unit cell and $a$ is the diameter of the particle. 




\subsection{}
Here we had to make code that tiled a space with spheres in a face-centered cubic (FCC) lattice. The code for the generation of this lattice is found in Appendix~\ref{app:E4.b}.

On the web app for plotting this lattice, Figure~\ref{fig: Fcc lattice} was made using the file that was generated.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.5\linewidth]{graphs/E4/FCC.png}
	\caption{Here the cubic lattice generated by the code is graphed}
	\label{fig: Fcc lattice}
\end{figure}




\subsection{}
We want to know the maximum packing density for spheres in a FCC lattice.

to get this we will use the same process as in \ref{sec:4b}. We know that our primitive translation vectors are
\begin{equation*}
	a_1 = \frac{a}{\sqrt{2}}\begin{pmatrix} 0 \\ 1 \\ 1 \end{pmatrix},\ a_2 = \frac{a}{\sqrt{2}}\begin{pmatrix} 1 \\ 0 \\ 1 \end{pmatrix},\ a_3 = \frac{a}{\sqrt{2}}\begin{pmatrix} 1 \\ 1 \\ 0 \end{pmatrix}
\end{equation*}
If we do this we have a problem, choosing the unit cell with length $a$ in each direction leads to a non-translation symmetric unit cell. To get a translation symmetric unit cell we have to chose the length of the unit cell to be $\sqrt{2}a$. 

Looking at the unit cell we can see that for each corner $1/8$th of a sphere exists and we get $1/2$ for each face of the cube, meaning the cube contains $8*1/8 + 6*1/2 = 4$ spheres

From this we know that if we look at how much particles would be in a unit cell we see that this would be 

\begin{eqnarray}
	f_o = \frac{4V_p}{V_{uc}} = \frac{\frac{16}{3}\pi (\frac{a}{2})^3}{(\sqrt{2}a)^3} = \frac{\pi}{3\sqrt{2}}
\end{eqnarray}




\subsection{}
The code for this \textbf{$read\_data()$} subroutine is found in Appendix~\ref{app:E4.c}.

what we do in this part is, we first define a new data structure such that we can pass multiple things back from the reading. This structure is defined such that we can later define the number of points that the pointer should be able to count to with $N$ found in the file. We also want to pass back the box dimensions and the size of each particle.

After this we load the file, it first reads the first line getting the number of particles. Now we can define the size of the position matrix and size vector. Then we read the dimensions of the box and place them in a matrix as well. Finally we read all the particle position and the size of each particle and close the file.




\subsection{}
The code for this \textbf{$move\_particle()$} subroutine is found in Appendix~\ref{app:E4.d}.

Here we again define a new data structure where we can store the randomized x,y,z displacements, and the randomly selected particle.

then we just generate a four random numbers in the [-0.5,0.5] domain. Three of these are used to get a random pointing vector. This vector is normalized to have a length of one, then the last random number is scaled by 2*Delta to scale the vector to be in the [-delta, delta] domain.

One more random number is generated between [0,1] this is scaled by the number of particles and is floored to get a random particle choice.

using the function explained in the next section the validity of this translation is check. If one is returned no overlap between particles is detected.

If the translation is valid, it is executed else it is skipped. The periodic boundary conditions are implemented here.

Keep in min that if the packing is the most efficient it can be all the balls are touching each other and there can be no valid non overlapping translations, meaning that if we increase the spacing between the particles only then we can have valid translations.

A "good" choice for delta is expected distance between particles over 2, then we know that the chance of a non overlapping translation will be decently sized.




\subsection{}
The code for this \textbf{$check\_particle\_overlap()$} subroutine is found in Appendix~\ref{app:E4.e}.

This routine takes in the particle positions, it checks if when the translation occurs there is no overlap by seeing if the minimum distance between any two particles is smaller than the two radius's summed.

This is done with periodic boundaries by checking if the distance greater then 1/2 the length of the box, if so then the distance is changed with the length of the box.




\subsection{}
a new function is made depicted in appendix \ref{app:E4.f} that saves the current location of each particle in a new file with the same structure as gotten from the saved file.

The results of this NVT ensemble evolution of a cubic lattice are plotted in Figure~\ref{fig: cubic time evolved}.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.5\linewidth]{graphs/E4/NTV procession.png}
	\caption{Here the cubic lattice generated is perturbed 100000 times to give this configuration}
	\label{fig: cubic time evolved}
\end{figure}





\subsection{}
here we are asked to change the packing density, I will assume this is done by changing the particle size, perturbing and seeing if the structure is still fcc like.

In Figure~\ref{fig:packing density sweep NVT}, configurations corresponding to different particle sizes are shown. For a particle size of 1, no translations are allowed due to the close packing. Reducing the particle size to 0.5 leads to a clearly disordered configuration. This means that the transition from an ordered to a disordered state occurs at an intermediate particle size.

At a particle size of 0.75, also gives a disordered system, however less so. With a particle size of 0.87 the structure is still a perfect FCC lattice. At a size of 0.81 the particles start to be disordered.


So the lattice melts somewhere between
\begin{equation*}
\frac{\pi\cdot0.5^3}{2\sqrt{2}}\hspace*{1.5cm}\&\hspace*{1.5cm} \frac{\pi\cdot0.8^3}{2\sqrt{2}}
\end{equation*}
as a packing density.


\begin{figure}[H]
	\centering
	\subfloat[particle size is 0.5]{\includegraphics[width=0.35\linewidth]{graphs/E4/50.png}}
	\subfloat[particle size is 0.75]{\includegraphics[width=0.35\linewidth]{graphs/E4/75.png}}\\
	\subfloat[particle size is 0.81]{\includegraphics[width=0.35\linewidth]{graphs/E4/81.png}}
	\subfloat[particle size is 0.87]{\includegraphics[width=0.35\linewidth]{graphs/E4/87.png}}
	\caption{The packing density changed}
	\label{fig:packing density sweep NVT}
\end{figure}




